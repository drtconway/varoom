#include "varoom/hgvs/transcript_index.hpp"

#include <unordered_map>

#define BOOST_TEST_DYN_LINK
#define BOOST_TEST_MODULE transcript_index tests
#include <boost/test/unit_test.hpp>

using namespace nlohmann;

namespace // anonymous
{
    json tx_jsons = R"([
   {
      "cdsStart" : 7576536,
      "txEnd" : 7590868,
      "accession" : "NM_001126113",
      "strand" : "-",
      "txStart" : 7571719,
      "gene" : "TP53",
      "exons" : [
         [7571719, 7573008],
         [7573926, 7574033],
         [7576524, 7576584],
         [7576852, 7576926],
         [7577018, 7577155],
         [7577498, 7577608],
         [7578176, 7578289],
         [7578370, 7578554],
         [7579311, 7579590],
         [7579699, 7579721],
         [7579838, 7579940],
         [7590694, 7590868]
      ],
      "cdsEnd" : 7579912,
      "chr" : "chr17"
   },
   {
      "txEnd" : 7590868,
      "cdsStart" : 7576624,
      "accession" : "NM_001126114",
      "strand" : "-",
      "txStart" : 7571719,
      "gene" : "TP53",
      "chr" : "chr17",
      "exons" : [
         [7571719, 7573008],
         [7573926, 7574033],
         [7576524, 7576657],
         [7576852, 7576926],
         [7577018, 7577155],
         [7577498, 7577608],
         [7578176, 7578289],
         [7578370, 7578554],
         [7579311, 7579590],
         [7579699, 7579721],
         [7579838, 7579940],
         [7590694, 7590868]
      ],
      "cdsEnd" : 7579912
   },
   {
      "cdsStart" : 128748839,
      "txEnd" : 128755197,
      "accession" : "NM_002467",
      "gene" : "MYC",
      "cdsEnd" : 128753204,
      "exons" : [
         [128748476, 128748869],
         [128750493, 128751265],
         [128752641, 128755197]
      ],
      "chr" : "chr8",
      "strand" : "+",
      "txStart" : 128748476
   },
   {
      "accession" : "NM_001346897",
      "txEnd" : 55270769,
      "cdsStart" : 55086970,
      "txStart" : 55086713,
      "strand" : "+",
      "chr" : "chr7",
      "cdsEnd" : 55270458,
      "exons" : [
         [55086713, 55087058],
         [55209978, 55210130],
         [55210997, 55211181],
         [55218986, 55219055],
         [55220238, 55220357],
         [55221703, 55221845],
         [55223522, 55223639],
         [55224225, 55224352],
         [55224451, 55224525],
         [55225355, 55225446],
         [55227831, 55228031],
         [55229191, 55229324],
         [55231425, 55231516],
         [55232972, 55233130],
         [55238867, 55238906],
         [55240675, 55240817],
         [55241613, 55241736],
         [55242414, 55242513],
         [55248985, 55249171],
         [55259411, 55259567],
         [55260458, 55260534],
         [55266409, 55266556],
         [55268008, 55268106],
         [55268880, 55269048],
         [55269427, 55269475],
         [55270209, 55270769]
      ],
      "gene" : "EGFR"
   },
   {
      "accession" : "NM_001322007",
      "txEnd" : 6048737,
      "cdsStart" : 6013029,
      "txStart" : 6010555,
      "strand" : "-",
      "chr" : "chr7",
      "cdsEnd" : 6043637,
      "exons" : [
         [6010555, 6013173],
         [6017218, 6017388],
         [6018226, 6018327],
         [6022454, 6022622],
         [6026389, 6027251],
         [6029430, 6029586],
         [6031603, 6031688],
         [6035164, 6035264],
         [6036956, 6037054],
         [6038738, 6038906],
         [6042083, 6042267],
         [6043602, 6043689],
         [6045522, 6045662],
         [6048627, 6048737]
      ],
      "gene" : "PMS2"
   },
   {
      "txStart" : 47630205,
      "strand" : "+",
      "chr" : "chr2",
      "exons" : [
         [47630205, 47630314],
         [47630498, 47630541],
         [47635539, 47635694],
         [47637232, 47637511],
         [47639552, 47639699],
         [47641407, 47641557],
         [47643434, 47643568],
         [47656880, 47657080],
         [47672686, 47672796],
         [47690169, 47690293],
         [47693796, 47693947],
         [47698103, 47698201],
         [47702163, 47702409],
         [47703505, 47703710],
         [47705410, 47705658],
         [47707834, 47708010],
         [47709917, 47710367]
      ],
      "cdsEnd" : 47710088,
      "gene" : "MSH2",
      "accession" : "NM_001258281",
      "txEnd" : 47710367,
      "cdsStart" : 47630528
   },
   {
      "chr" : "chr7",
      "exons" : [
         [55177509, 55177651],
         [55209978, 55210130],
         [55210997, 55211181],
         [55214298, 55214433],
         [55218986, 55219055],
         [55220238, 55220357],
         [55221703, 55221845],
         [55223522, 55223639],
         [55224225, 55224352],
         [55224451, 55224525],
         [55225355, 55225446],
         [55227831, 55228031],
         [55229191, 55229324],
         [55231425, 55231516],
         [55232972, 55233130],
         [55238867, 55238906],
         [55240675, 55240817],
         [55241613, 55241736],
         [55242414, 55242513],
         [55248985, 55249171],
         [55259411, 55259567],
         [55260458, 55260534],
         [55266409, 55266556],
         [55268008, 55268106],
         [55268880, 55269048],
         [55269427, 55269475],
         [55270209, 55270318],
         [55272948, 55275773]
      ],
      "cdsEnd" : 55273310,
      "gene" : "EGFR",
      "txStart" : 55177509,
      "strand" : "+",
      "accession" : "NM_001346900",
      "txEnd" : 55275773,
      "cdsStart" : 55210049
   },
   {
      "strand" : "-",
      "txStart" : 140419126,
      "gene" : "BRAF",
      "exons" : [
         [140419126, 140426316],
         [140434416, 140434570],
         [140439611, 140439746],
         [140449086, 140449218],
         [140453074, 140453193],
         [140453986, 140454033],
         [140476711, 140476888],
         [140477790, 140477875],
         [140481375, 140481493],
         [140482820, 140482957],
         [140487347, 140487384],
         [140494107, 140494267],
         [140500161, 140500281],
         [140501211, 140501360],
         [140507759, 140507862],
         [140508691, 140508795],
         [140534408, 140534672],
         [140549910, 140550012],
         [140624365, 140624728]
      ],
      "cdsEnd" : 140624503,
      "chr" : "chr7",
      "cdsStart" : 140426293,
      "txEnd" : 140624728,
      "accession" : "NM_001354609"
   },
   {
      "chr" : "chr7",
      "cdsEnd" : 6042215,
      "exons" : [
         [6010555, 6013173],
         [6017218, 6017388],
         [6018226, 6018327],
         [6022454, 6022622],
         [6026389, 6027251],
         [6029430, 6029586],
         [6031603, 6031688],
         [6035164, 6035264],
         [6036956, 6037054],
         [6038738, 6038906],
         [6042083, 6042267],
         [6043320, 6043423],
         [6043602, 6043689],
         [6048627, 6048737]
      ],
      "gene" : "PMS2",
      "txStart" : 6010555,
      "strand" : "-",
      "accession" : "NM_001322004",
      "txEnd" : 6048737,
      "cdsStart" : 6013029
   },
   {
      "accession" : "NR_136154",
      "txEnd" : 6048737,
      "cdsStart" : 6048737,
      "chr" : "chr7",
      "cdsEnd" : 6048737,
      "exons" : [
         [6010555, 6013173],
         [6017218, 6017345],
         [6018226, 6018327],
         [6022454, 6022622],
         [6026389, 6027251],
         [6029430, 6029586],
         [6031603, 6031688],
         [6035164, 6035264],
         [6036956, 6037054],
         [6038738, 6038906],
         [6042083, 6042267],
         [6043320, 6043423],
         [6043602, 6043689],
         [6045522, 6045662],
         [6048627, 6048737]
      ],
      "gene" : "PMS2",
      "txStart" : 6010555,
      "strand" : "-"
   },
   {
      "txEnd" : 41277500,
      "cdsStart" : 41197694,
      "accession" : "NM_007300",
      "gene" : "BRCA1",
      "chr" : "chr17",
      "exons" : [
         [41196311, 41197819],
         [41199659, 41199720],
         [41201137, 41201211],
         [41203079, 41203134],
         [41209068, 41209152],
         [41215349, 41215390],
         [41215890, 41215968],
         [41219624, 41219712],
         [41222944, 41223255],
         [41226347, 41226538],
         [41228504, 41228628],
         [41231350, 41231416],
         [41234420, 41234592],
         [41242960, 41243049],
         [41243451, 41246877],
         [41247862, 41247939],
         [41249260, 41249306],
         [41251791, 41251897],
         [41256138, 41256278],
         [41256884, 41256973],
         [41258472, 41258550],
         [41267742, 41267796],
         [41276033, 41276132],
         [41277287, 41277500]
      ],
      "cdsEnd" : 41276113,
      "strand" : "-",
      "txStart" : 41196311
   },
   {
      "txStart" : 6010555,
      "strand" : "-",
      "chr" : "chr7",
      "exons" : [
         [6010555, 6013173],
         [6017218, 6017388],
         [6018226, 6018327],
         [6022454, 6022622],
         [6026389, 6027251],
         [6029430, 6029586],
         [6031603, 6031688],
         [6035164, 6035264],
         [6036956, 6037054],
         [6038738, 6038857],
         [6042083, 6042267],
         [6043320, 6043423],
         [6043602, 6043689],
         [6045522, 6045657],
         [6048627, 6048737]
      ],
      "cdsEnd" : 6031658,
      "gene" : "PMS2",
      "accession" : "NM_001322012",
      "txEnd" : 6048737,
      "cdsStart" : 6013029
   },
   {
      "txEnd" : 6048737,
      "cdsStart" : 6013029,
      "accession" : "NM_001322010",
      "gene" : "PMS2",
      "chr" : "chr7",
      "exons" : [
         [6010555, 6013173],
         [6017218, 6017388],
         [6018226, 6018327],
         [6022454, 6022622],
         [6026389, 6027251],
         [6031603, 6031688],
         [6035164, 6035264],
         [6036956, 6037054],
         [6038738, 6038906],
         [6042083, 6042267],
         [6043320, 6043423],
         [6043602, 6043689],
         [6048627, 6048737]
      ],
      "cdsEnd" : 6042215,
      "strand" : "-",
      "txStart" : 6010555
   },
   {
      "strand" : "-",
      "txStart" : 7571719,
      "gene" : "TP53",
      "cdsEnd" : 7578452,
      "exons" : [
         [7571719, 7573008],
         [7573926, 7574033],
         [7576524, 7576657],
         [7576852, 7576926],
         [7577018, 7577155],
         [7577498, 7577608],
         [7578176, 7578289],
         [7578370, 7578811]
      ],
      "chr" : "chr17",
      "cdsStart" : 7576624,
      "txEnd" : 7578811,
      "accession" : "NM_001276698"
   },
   {
      "accession" : "NM_001276697",
      "txEnd" : 7578811,
      "cdsStart" : 7572926,
      "txStart" : 7571719,
      "strand" : "-",
      "chr" : "chr17",
      "exons" : [
         [7571719, 7573008],
         [7573926, 7574033],
         [7576852, 7576926],
         [7577018, 7577155],
         [7577498, 7577608],
         [7578176, 7578289],
         [7578370, 7578811]
      ],
      "cdsEnd" : 7578452,
      "gene" : "TP53"
   },
   {
      "txEnd" : 7590868,
      "cdsStart" : 7576624,
      "accession" : "NM_001276696",
      "gene" : "TP53",
      "chr" : "chr17",
      "cdsEnd" : 7579569,
      "exons" : [
         [7571719, 7573008],
         [7573926, 7574033],
         [7576524, 7576657],
         [7576852, 7576926],
         [7577018, 7577155],
         [7577498, 7577608],
         [7578176, 7578289],
         [7578370, 7578554],
         [7579311, 7579590],
         [7579699, 7579721],
         [7579838, 7579940],
         [7590694, 7590868]
      ],
      "strand" : "-",
      "txStart" : 7571719
   },
   {
      "accession" : "NM_001276695",
      "cdsStart" : 7576536,
      "txEnd" : 7590868,
      "txStart" : 7571719,
      "strand" : "-",
      "exons" : [
         [7571719, 7573008],
         [7573926, 7574033],
         [7576524, 7576584],
         [7576852, 7576926],
         [7577018, 7577155],
         [7577498, 7577608],
         [7578176, 7578289],
         [7578370, 7578554],
         [7579311, 7579590],
         [7579699, 7579721],
         [7579838, 7579940],
         [7590694, 7590868]
      ],
      "cdsEnd" : 7579569,
      "chr" : "chr17",
      "gene" : "TP53"
   },
   {
      "gene" : "PMS2",
      "exons" : [
         [6010555, 6013173],
         [6017218, 6017388],
         [6018226, 6018327],
         [6022454, 6022622],
         [6026389, 6027251],
         [6029430, 6029586],
         [6031603, 6031688],
         [6035164, 6035264],
         [6036956, 6037054],
         [6038738, 6038906],
         [6042083, 6042267],
         [6043320, 6043423],
         [6043602, 6043689],
         [6045522, 6045657],
         [6048627, 6048737]
      ],
      "cdsEnd" : 6042215,
      "chr" : "chr7",
      "strand" : "-",
      "txStart" : 6010555,
      "cdsStart" : 6013029,
      "txEnd" : 6048737,
      "accession" : "NM_001322003"
   },
   {
      "accession" : "NM_001354870",
      "cdsStart" : 128748839,
      "txEnd" : 128755197,
      "txStart" : 128747679,
      "strand" : "+",
      "cdsEnd" : 128753204,
      "exons" : [
         [128747679, 128748869],
         [128750496, 128751265],
         [128752641, 128755197]
      ],
      "chr" : "chr8",
      "gene" : "MYC"
   },
   {
      "cdsStart" : 6013029,
      "txEnd" : 6048737,
      "accession" : "NM_001322011",
      "gene" : "PMS2",
      "exons" : [
         [6010555, 6013173],
         [6017218, 6017388],
         [6018226, 6018327],
         [6022454, 6022622],
         [6026389, 6027251],
         [6029430, 6029586],
         [6031603, 6031688],
         [6035164, 6035264],
         [6036956, 6037054],
         [6038738, 6038857],
         [6042083, 6042267],
         [6043320, 6043423],
         [6043602, 6043689],
         [6045522, 6045662],
         [6048627, 6048737]
      ],
      "cdsEnd" : 6031658,
      "chr" : "chr7",
      "strand" : "-",
      "txStart" : 6010555
   },
   {
      "exons" : [
         [108094255, 108094413],
         [108098321, 108098423],
         [108098502, 108098615],
         [108099904, 108100091]
      ],
      "cdsEnd" : 108100058,
      "chr" : "chr11",
      "gene" : "ATM",
      "txStart" : 108094255,
      "strand" : "+",
      "accession" : "NM_001351836",
      "cdsStart" : 108098351,
      "txEnd" : 108100091
   },
   {
      "strand" : "+",
      "txStart" : 108093558,
      "gene" : "ATM",
      "chr" : "chr11",
      "cdsEnd" : 108100058,
      "exons" : [
         [108093558, 108093913],
         [108098321, 108098423],
         [108098502, 108098615],
         [108099904, 108100091]
      ],
      "txEnd" : 108100091,
      "cdsStart" : 108098351,
      "accession" : "NM_001351835"
   },
   {
      "strand" : "+",
      "txStart" : 108093558,
      "gene" : "ATM",
      "cdsEnd" : 108236235,
      "exons" : [
         [108093558, 108093913],
         [108095510, 108095598],
         [108098321, 108098423],
         [108098502, 108098615],
         [108099904, 108100050],
         [108106396, 108106561],
         [108114679, 108114845],
         [108115514, 108115753],
         [108117690, 108117854],
         [108119659, 108119829],
         [108121427, 108121799],
         [108122563, 108122758],
         [108123543, 108123639],
         [108124540, 108124766],
         [108126941, 108127067],
         [108128207, 108128333],
         [108129712, 108129802],
         [108137897, 108138069],
         [108139136, 108139336],
         [108141790, 108141873],
         [108141977, 108142133],
         [108143258, 108143334],
         [108143448, 108143579],
         [108150217, 108150335],
         [108151721, 108151895],
         [108153436, 108153606],
         [108154953, 108155200],
         [108158326, 108158442],
         [108159703, 108159830],
         [108160328, 108160528],
         [108163345, 108163520],
         [108164039, 108164204],
         [108165653, 108165786],
         [108168013, 108168109],
         [108170440, 108170612],
         [108172374, 108172516],
         [108173579, 108173756],
         [108175401, 108175579],
         [108178623, 108178711],
         [108180886, 108181042],
         [108183137, 108183225],
         [108186549, 108186638],
         [108186737, 108186840],
         [108188099, 108188248],
         [108190680, 108190785],
         [108192027, 108192147],
         [108196036, 108196271],
         [108196784, 108196952],
         [108198371, 108198485],
         [108199747, 108199965],
         [108200940, 108201148],
         [108202170, 108202284],
         [108202605, 108202764],
         [108203488, 108203627],
         [108204612, 108204695],
         [108205695, 108205836],
         [108206571, 108206688],
         [108213948, 108214098],
         [108216469, 108216635],
         [108218005, 108218092],
         [108224492, 108224607],
         [108225537, 108225601],
         [108235808, 108235945],
         [108236051, 108239826]
      ],
      "chr" : "chr11",
      "cdsStart" : 108098351,
      "txEnd" : 108239826,
      "accession" : "NM_001351834"
   },
   {
      "accession" : "NR_027676",
      "cdsStart" : 41277340,
      "txEnd" : 41277340,
      "exons" : [
         [41196311, 41197819],
         [41199659, 41199720],
         [41201137, 41201211],
         [41203079, 41203134],
         [41209068, 41209152],
         [41215349, 41215390],
         [41215890, 41215968],
         [41219624, 41219712],
         [41222944, 41223255],
         [41226347, 41226538],
         [41228504, 41228631],
         [41234420, 41234592],
         [41242960, 41243049],
         [41243451, 41246877],
         [41247862, 41247939],
         [41249260, 41249306],
         [41251791, 41251894],
         [41256138, 41256278],
         [41256884, 41256973],
         [41258494, 41258550],
         [41267742, 41267796],
         [41276033, 41276132],
         [41277198, 41277340]
      ],
      "cdsEnd" : 41277340,
      "chr" : "chr17",
      "gene" : "BRCA1",
      "txStart" : 41196311,
      "strand" : "-"
   },
   {
      "accession" : "NM_001322006",
      "txEnd" : 6048737,
      "cdsStart" : 6013029,
      "chr" : "chr7",
      "exons" : [
         [6010555, 6013173],
         [6017218, 6017388],
         [6018226, 6018327],
         [6022454, 6022622],
         [6026389, 6027251],
         [6031603, 6031688],
         [6035164, 6035264],
         [6036956, 6037054],
         [6038738, 6038906],
         [6042083, 6042267],
         [6043320, 6043423],
         [6043602, 6043689],
         [6045522, 6045662],
         [6048627, 6048737]
      ],
      "cdsEnd" : 6048650,
      "gene" : "PMS2",
      "txStart" : 6010555,
      "strand" : "-"
   },
   {
      "txStart" : 55086709,
      "strand" : "+",
      "chr" : "chr7",
      "exons" : [
         [55086709, 55087058],
         [55209978, 55210130],
         [55210997, 55211181],
         [55214298, 55214433],
         [55218986, 55219055],
         [55220238, 55220357],
         [55221703, 55221845],
         [55223522, 55223639],
         [55224225, 55224352],
         [55224451, 55224525],
         [55225355, 55225446],
         [55227831, 55228031],
         [55229191, 55229324],
         [55231425, 55231516],
         [55232972, 55233130],
         [55238867, 55238906],
         [55240675, 55240817],
         [55241613, 55241736],
         [55242414, 55242513],
         [55248985, 55249171],
         [55259411, 55259567],
         [55260458, 55260534],
         [55266409, 55266556],
         [55268008, 55268106],
         [55268880, 55269048],
         [55269427, 55269475],
         [55270209, 55270318],
         [55272948, 55279321]
      ],
      "cdsEnd" : 55273310,
      "gene" : "EGFR",
      "accession" : "NM_005228",
      "txEnd" : 55279321,
      "cdsStart" : 55086970
   },
   {
      "exons" : [
         [6010555, 6013173],
         [6017218, 6017421],
         [6018226, 6018327],
         [6022454, 6022622],
         [6026389, 6027251],
         [6029430, 6029586],
         [6031603, 6031688],
         [6035164, 6035264],
         [6036956, 6037054],
         [6038738, 6038906],
         [6042083, 6042267],
         [6043320, 6043423],
         [6043602, 6043689],
         [6045522, 6045657],
         [6048437, 6048659]
      ],
      "cdsEnd" : 6042215,
      "chr" : "chr7",
      "gene" : "PMS2",
      "txStart" : 6010555,
      "strand" : "-",
      "accession" : "NM_001322009",
      "cdsStart" : 6013029,
      "txEnd" : 6048659
   },
   {
      "txStart" : 108093558,
      "strand" : "+",
      "chr" : "chr11",
      "cdsEnd" : 108236235,
      "exons" : [
         [108093558, 108093913],
         [108098321, 108098423],
         [108098502, 108098615],
         [108099904, 108100050],
         [108106396, 108106561],
         [108114679, 108114845],
         [108115514, 108115753],
         [108117690, 108117854],
         [108119659, 108119829],
         [108121427, 108121799],
         [108122563, 108122758],
         [108123543, 108123639],
         [108124540, 108124766],
         [108126941, 108127067],
         [108128207, 108128333],
         [108129712, 108129802],
         [108137897, 108138069],
         [108139136, 108139336],
         [108141790, 108141873],
         [108141977, 108142133],
         [108143258, 108143334],
         [108143448, 108143579],
         [108150217, 108150335],
         [108151721, 108151895],
         [108153436, 108153606],
         [108154953, 108155200],
         [108158326, 108158442],
         [108159703, 108159830],
         [108160328, 108160528],
         [108163345, 108163520],
         [108164039, 108164204],
         [108165653, 108165786],
         [108168013, 108168109],
         [108170440, 108170612],
         [108172374, 108172516],
         [108173579, 108173756],
         [108175401, 108175579],
         [108178623, 108178711],
         [108180886, 108181042],
         [108183137, 108183225],
         [108186549, 108186638],
         [108186737, 108186840],
         [108188099, 108188248],
         [108190680, 108190785],
         [108192027, 108192147],
         [108196036, 108196271],
         [108196784, 108196952],
         [108198371, 108198485],
         [108199747, 108199965],
         [108200940, 108201148],
         [108202170, 108202284],
         [108202605, 108202764],
         [108203488, 108203627],
         [108204612, 108204695],
         [108205695, 108205836],
         [108206571, 108206688],
         [108213948, 108214098],
         [108216469, 108216635],
         [108218005, 108218092],
         [108224492, 108224607],
         [108225537, 108225601],
         [108235808, 108235945],
         [108236051, 108239826]
      ],
      "gene" : "ATM",
      "accession" : "NM_000051",
      "txEnd" : 108239826,
      "cdsStart" : 108098351
   },
   {
      "accession" : "NM_001322005",
      "cdsStart" : 6013029,
      "txEnd" : 6048659,
      "txStart" : 6010555,
      "strand" : "-",
      "exons" : [
         [6010555, 6013173],
         [6017218, 6017388],
         [6018226, 6018327],
         [6022454, 6022622],
         [6026389, 6027251],
         [6029430, 6029586],
         [6031603, 6031688],
         [6035164, 6035264],
         [6036956, 6037054],
         [6038738, 6038906],
         [6042083, 6042267],
         [6043320, 6043423],
         [6043602, 6043689],
         [6045522, 6045662],
         [6048437, 6048659]
      ],
      "cdsEnd" : 6042215,
      "chr" : "chr7",
      "gene" : "PMS2"
   },
   {
      "txEnd" : 55275773,
      "cdsStart" : 55086970,
      "accession" : "NM_001346899",
      "strand" : "+",
      "txStart" : 55086713,
      "gene" : "EGFR",
      "chr" : "chr7",
      "cdsEnd" : 55273310,
      "exons" : [
         [55086713, 55087058],
         [55209978, 55210130],
         [55210997, 55211181],
         [55218986, 55219055],
         [55220238, 55220357],
         [55221703, 55221845],
         [55223522, 55223639],
         [55224225, 55224352],
         [55224451, 55224525],
         [55225355, 55225446],
         [55227831, 55228031],
         [55229191, 55229324],
         [55231425, 55231516],
         [55232972, 55233130],
         [55238867, 55238906],
         [55240675, 55240817],
         [55241613, 55241736],
         [55242414, 55242513],
         [55248985, 55249171],
         [55259411, 55259567],
         [55260458, 55260534],
         [55266409, 55266556],
         [55268008, 55268106],
         [55268880, 55269048],
         [55269427, 55269475],
         [55270209, 55270318],
         [55272948, 55275773]
      ]
   },
   {
      "chr" : "chr17",
      "cdsEnd" : 7579569,
      "exons" : [
         [7571719, 7573008],
         [7573926, 7574033],
         [7576852, 7576926],
         [7577018, 7577155],
         [7577498, 7577608],
         [7578176, 7578289],
         [7578370, 7578554],
         [7579311, 7579590],
         [7579699, 7579940],
         [7590694, 7590868]
      ],
      "gene" : "TP53",
      "txStart" : 7571719,
      "strand" : "-",
      "accession" : "NM_001126118",
      "txEnd" : 7590868,
      "cdsStart" : 7572926
   },
   {
      "cdsStart" : 6013029,
      "txEnd" : 6048737,
      "accession" : "NM_001322008",
      "gene" : "PMS2",
      "exons" : [
         [6010555, 6013173],
         [6017218, 6017388],
         [6018226, 6018327],
         [6022454, 6022622],
         [6026389, 6027251],
         [6029430, 6029586],
         [6031603, 6031688],
         [6035164, 6035264],
         [6036956, 6037054],
         [6038738, 6038906],
         [6042083, 6042267],
         [6043602, 6043689],
         [6048627, 6048737]
      ],
      "cdsEnd" : 6043637,
      "chr" : "chr7",
      "strand" : "-",
      "txStart" : 6010555
   },
   {
      "cdsStart" : 6013029,
      "txEnd" : 6048680,
      "accession" : "NM_000535",
      "gene" : "PMS2",
      "cdsEnd" : 6048650,
      "exons" : [
         [6010555, 6013173],
         [6017218, 6017388],
         [6018226, 6018327],
         [6022454, 6022622],
         [6026389, 6027251],
         [6029430, 6029586],
         [6031603, 6031688],
         [6035164, 6035264],
         [6036956, 6037054],
         [6038738, 6038906],
         [6042083, 6042267],
         [6043320, 6043423],
         [6043602, 6043689],
         [6045522, 6045662],
         [6048627, 6048680]
      ],
      "chr" : "chr7",
      "strand" : "-",
      "txStart" : 6010555
   },
   {
      "gene" : "TP53",
      "chr" : "chr17",
      "cdsEnd" : 7579912,
      "exons" : [
         [7571719, 7573008],
         [7573926, 7574033],
         [7576852, 7576926],
         [7577018, 7577155],
         [7577498, 7577608],
         [7578176, 7578289],
         [7578370, 7578554],
         [7579311, 7579590],
         [7579699, 7579721],
         [7579838, 7579940],
         [7590694, 7590868]
      ],
      "strand" : "-",
      "txStart" : 7571719,
      "txEnd" : 7590868,
      "cdsStart" : 7572926,
      "accession" : "NM_000546"
   },
   {
      "accession" : "NM_001276699",
      "txEnd" : 7578811,
      "cdsStart" : 7576536,
      "chr" : "chr17",
      "cdsEnd" : 7578452,
      "exons" : [
         [7571719, 7573008],
         [7573926, 7574033],
         [7576524, 7576584],
         [7576852, 7576926],
         [7577018, 7577155],
         [7577498, 7577608],
         [7578176, 7578289],
         [7578370, 7578811]
      ],
      "gene" : "TP53",
      "txStart" : 7571719,
      "strand" : "-"
   },
   {
      "txStart" : 7571719,
      "strand" : "-",
      "cdsEnd" : 7579569,
      "exons" : [
         [7571719, 7573008],
         [7573926, 7574033],
         [7576852, 7576926],
         [7577018, 7577155],
         [7577498, 7577608],
         [7578176, 7578289],
         [7578370, 7578554],
         [7579311, 7579590],
         [7579699, 7579721],
         [7579838, 7579940],
         [7590694, 7590868]
      ],
      "chr" : "chr17",
      "gene" : "TP53",
      "accession" : "NM_001276760",
      "cdsStart" : 7572926,
      "txEnd" : 7590868
   },
   {
      "accession" : "NM_004119",
      "cdsStart" : 28578188,
      "txEnd" : 28674729,
      "txStart" : 28577410,
      "strand" : "-",
      "exons" : [
         [28577410, 28578311],
         [28588588, 28588694],
         [28589293, 28589393],
         [28589726, 28589838],
         [28592603, 28592726],
         [28597486, 28597614],
         [28598997, 28599080],
         [28601224, 28601378],
         [28602314, 28602425],
         [28608023, 28608128],
         [28608218, 28608351],
         [28608437, 28608544],
         [28609631, 28609810],
         [28610071, 28610180],
         [28611321, 28611425],
         [28622411, 28622580],
         [28623520, 28623674],
         [28623771, 28623911],
         [28624231, 28624359],
         [28626681, 28626811],
         [28631483, 28631599],
         [28636003, 28636206],
         [28644627, 28644749],
         [28674604, 28674729]
      ],
      "cdsEnd" : 28674647,
      "chr" : "chr13",
      "gene" : "FLT3"
   },
   {
      "strand" : "-",
      "txStart" : 140432363,
      "gene" : "BRAF",
      "chr" : "chr7",
      "exons" : [
         [140432363, 140434570],
         [140439611, 140439746],
         [140449086, 140449218],
         [140453074, 140453193],
         [140453986, 140454033],
         [140476711, 140476888],
         [140477790, 140477875],
         [140481375, 140481493],
         [140482820, 140482957],
         [140487347, 140487384],
         [140494107, 140494267],
         [140500161, 140500281],
         [140501211, 140501360],
         [140507759, 140507862],
         [140508691, 140508795],
         [140534408, 140534672],
         [140549910, 140550012],
         [140624365, 140624728]
      ],
      "cdsEnd" : 140624503,
      "txEnd" : 140624728,
      "cdsStart" : 140434396,
      "accession" : "NM_004333"
   },
   {
      "txEnd" : 6048737,
      "cdsStart" : 6013029,
      "accession" : "NM_001322013",
      "strand" : "-",
      "txStart" : 6010555,
      "gene" : "PMS2",
      "chr" : "chr7",
      "exons" : [
         [6010555, 6013173],
         [6017218, 6017388],
         [6018226, 6018327],
         [6022454, 6022622],
         [6026389, 6027251],
         [6029430, 6029586],
         [6031603, 6031688],
         [6035164, 6035264],
         [6036956, 6037054],
         [6042083, 6042267],
         [6043320, 6043423],
         [6043602, 6043689],
         [6045522, 6045657],
         [6048627, 6048737]
      ],
      "cdsEnd" : 6042215
   },
   {
      "exons" : [
         [55086724, 55087058],
         [55209978, 55210130],
         [55210997, 55211181],
         [55214298, 55214433],
         [55218986, 55219055],
         [55220238, 55220357],
         [55221703, 55221845],
         [55223522, 55223639],
         [55224225, 55224352],
         [55224451, 55224525],
         [55225355, 55225446],
         [55227831, 55228031],
         [55229191, 55229324],
         [55231425, 55231516],
         [55232972, 55233130],
         [55237999, 55238738]
      ],
      "cdsEnd" : 55238237,
      "chr" : "chr7",
      "gene" : "EGFR",
      "txStart" : 55086724,
      "strand" : "+",
      "accession" : "NM_201284",
      "cdsStart" : 55086970,
      "txEnd" : 55238738
   },
   {
      "txEnd" : 55224644,
      "cdsStart" : 55086970,
      "accession" : "NM_201283",
      "gene" : "EGFR",
      "chr" : "chr7",
      "cdsEnd" : 55224536,
      "exons" : [
         [55086724, 55087058],
         [55209978, 55210130],
         [55210997, 55211181],
         [55214298, 55214433],
         [55218986, 55219055],
         [55220238, 55220357],
         [55221703, 55221845],
         [55223522, 55223639],
         [55224225, 55224352],
         [55224451, 55224644]
      ],
      "strand" : "+",
      "txStart" : 55086724
   },
   {
      "accession" : "NM_201282",
      "txEnd" : 55236328,
      "cdsStart" : 55086970,
      "txStart" : 55086724,
      "strand" : "+",
      "chr" : "chr7",
      "exons" : [
         [55086724, 55087058],
         [55209978, 55210130],
         [55210997, 55211181],
         [55214298, 55214433],
         [55218986, 55219055],
         [55220238, 55220357],
         [55221703, 55221845],
         [55223522, 55223639],
         [55224225, 55224352],
         [55224451, 55224525],
         [55225355, 55225446],
         [55227831, 55228031],
         [55229191, 55229324],
         [55231425, 55231516],
         [55232972, 55233130],
         [55236215, 55236328]
      ],
      "cdsEnd" : 55236222,
      "gene" : "EGFR"
   },
   {
      "gene" : "EGFR",
      "chr" : "chr7",
      "cdsEnd" : 55270458,
      "exons" : [
         [55086713, 55087058],
         [55209978, 55210130],
         [55210997, 55211181],
         [55214298, 55214433],
         [55218986, 55219055],
         [55220238, 55220357],
         [55221703, 55221845],
         [55223522, 55223639],
         [55224225, 55224352],
         [55224451, 55224525],
         [55225355, 55225446],
         [55227831, 55228031],
         [55229191, 55229324],
         [55231425, 55231516],
         [55232972, 55233130],
         [55238867, 55238906],
         [55240675, 55240817],
         [55241613, 55241736],
         [55242414, 55242513],
         [55248985, 55249171],
         [55259411, 55259567],
         [55260458, 55260534],
         [55266409, 55266556],
         [55268008, 55268106],
         [55268880, 55269048],
         [55269427, 55269475],
         [55270209, 55270769]
      ],
      "strand" : "+",
      "txStart" : 55086713,
      "txEnd" : 55270769,
      "cdsStart" : 55086970,
      "accession" : "NM_001346898"
   },
   {
      "cdsStart" : 7576536,
      "txEnd" : 7578811,
      "accession" : "NM_001126117",
      "gene" : "TP53",
      "cdsEnd" : 7578533,
      "exons" : [
         [7571719, 7573008],
         [7573926, 7574033],
         [7576524, 7576584],
         [7576852, 7576926],
         [7577018, 7577155],
         [7577498, 7577608],
         [7578176, 7578289],
         [7578370, 7578811]
      ],
      "chr" : "chr17",
      "strand" : "-",
      "txStart" : 7571719
   },
   {
      "accession" : "NM_001126116",
      "cdsStart" : 7576624,
      "txEnd" : 7578811,
      "txStart" : 7571719,
      "strand" : "-",
      "cdsEnd" : 7578533,
      "exons" : [
         [7571719, 7573008],
         [7573926, 7574033],
         [7576524, 7576657],
         [7576852, 7576926],
         [7577018, 7577155],
         [7577498, 7577608],
         [7578176, 7578289],
         [7578370, 7578811]
      ],
      "chr" : "chr17",
      "gene" : "TP53"
   },
   {
      "txStart" : 7571719,
      "strand" : "-",
      "cdsEnd" : 7578533,
      "exons" : [
         [7571719, 7573008],
         [7573926, 7574033],
         [7576852, 7576926],
         [7577018, 7577155],
         [7577498, 7577608],
         [7578176, 7578289],
         [7578370, 7578811]
      ],
      "chr" : "chr17",
      "gene" : "TP53",
      "accession" : "NM_001126115",
      "cdsStart" : 7572926,
      "txEnd" : 7578811
   },
   {
      "cdsStart" : 47630330,
      "txEnd" : 47710367,
      "accession" : "NM_000251",
      "gene" : "MSH2",
      "exons" : [
         [47630205, 47630541],
         [47635539, 47635694],
         [47637232, 47637511],
         [47639552, 47639699],
         [47641407, 47641557],
         [47643434, 47643568],
         [47656880, 47657080],
         [47672686, 47672796],
         [47690169, 47690293],
         [47693796, 47693947],
         [47698103, 47698201],
         [47702163, 47702409],
         [47703505, 47703710],
         [47705410, 47705658],
         [47707834, 47708010],
         [47709917, 47710367]
      ],
      "cdsEnd" : 47710088,
      "chr" : "chr2",
      "strand" : "+",
      "txStart" : 47630205
   },
   {
      "txStart" : 6010555,
      "strand" : "-",
      "cdsEnd" : 6042311,
      "exons" : [
         [6010555, 6013173],
         [6017218, 6017388],
         [6018226, 6018327],
         [6022454, 6022622],
         [6026389, 6027251],
         [6029430, 6029586],
         [6031603, 6031688],
         [6035164, 6035264],
         [6036956, 6037054],
         [6038738, 6038906],
         [6042083, 6042442],
         [6043320, 6043423],
         [6043602, 6043689],
         [6045522, 6045657],
         [6048627, 6048737]
      ],
      "chr" : "chr7",
      "gene" : "PMS2",
      "accession" : "NM_001322015",
      "cdsStart" : 6013029,
      "txEnd" : 6048737
   },
   {
      "accession" : "NM_001126112",
      "txEnd" : 7590868,
      "cdsStart" : 7572926,
      "txStart" : 7571719,
      "strand" : "-",
      "chr" : "chr17",
      "cdsEnd" : 7579912,
      "exons" : [
         [7571719, 7573008],
         [7573926, 7574033],
         [7576852, 7576926],
         [7577018, 7577155],
         [7577498, 7577608],
         [7578176, 7578289],
         [7578370, 7578554],
         [7579311, 7579590],
         [7579699, 7579721],
         [7579838, 7579937],
         [7590694, 7590868]
      ],
      "gene" : "TP53"
   },
   {
      "accession" : "NM_001276761",
      "cdsStart" : 7572926,
      "txEnd" : 7590868,
      "exons" : [
         [7571719, 7573008],
         [7573926, 7574033],
         [7576852, 7576926],
         [7577018, 7577155],
         [7577498, 7577608],
         [7578176, 7578289],
         [7578370, 7578554],
         [7579311, 7579590],
         [7579699, 7579721],
         [7579838, 7579937],
         [7590694, 7590868]
      ],
      "cdsEnd" : 7579569,
      "chr" : "chr17",
      "gene" : "TP53",
      "txStart" : 7571719,
      "strand" : "-"
   },
   {
      "txEnd" : 6048737,
      "cdsStart" : 6013029,
      "accession" : "NM_001322014",
      "strand" : "-",
      "txStart" : 6010555,
      "gene" : "PMS2",
      "chr" : "chr7",
      "cdsEnd" : 6048650,
      "exons" : [
         [6010555, 6013173],
         [6017218, 6017421],
         [6018226, 6018327],
         [6022454, 6022622],
         [6026389, 6027251],
         [6029430, 6029586],
         [6031603, 6031688],
         [6035164, 6035264],
         [6036956, 6037054],
         [6038738, 6038906],
         [6042083, 6042267],
         [6043320, 6043423],
         [6043602, 6043689],
         [6045522, 6045662],
         [6048627, 6048737]
      ]
   },
   {
      "accession" : "NM_000059",
      "txEnd" : 32973809,
      "cdsStart" : 32890597,
      "chr" : "chr13",
      "cdsEnd" : 32972907,
      "exons" : [
         [32889616, 32889804],
         [32890558, 32890664],
         [32893213, 32893462],
         [32899212, 32899321],
         [32900237, 32900287],
         [32900378, 32900419],
         [32900635, 32900750],
         [32903579, 32903629],
         [32905055, 32905167],
         [32906408, 32907524],
         [32910401, 32915333],
         [32918694, 32918790],
         [32920963, 32921033],
         [32928997, 32929425],
         [32930564, 32930746],
         [32931878, 32932066],
         [32936659, 32936830],
         [32937315, 32937670],
         [32944538, 32944694],
         [32945092, 32945237],
         [32950806, 32950928],
         [32953453, 32953652],
         [32953886, 32954050],
         [32954143, 32954282],
         [32968825, 32969070],
         [32971034, 32971181],
         [32972298, 32973809]
      ],
      "gene" : "BRCA2",
      "txStart" : 32889616,
      "strand" : "+"
   },
   {
      "chr" : "chr13",
      "cdsEnd" : 28674729,
      "exons" : [
         [28577410, 28578311],
         [28588588, 28588694],
         [28589293, 28589393],
         [28589726, 28589838],
         [28592603, 28592726],
         [28597486, 28597614],
         [28598997, 28599080],
         [28599420, 28599552],
         [28601224, 28601378],
         [28602314, 28602425],
         [28608023, 28608128],
         [28608218, 28608351],
         [28608437, 28608544],
         [28609631, 28609810],
         [28610071, 28610180],
         [28611321, 28611425],
         [28622411, 28622580],
         [28623520, 28623674],
         [28623771, 28623911],
         [28624231, 28624359],
         [28626681, 28626811],
         [28631483, 28631599],
         [28636003, 28636206],
         [28644627, 28644749],
         [28674604, 28674729]
      ],
      "gene" : "FLT3",
      "txStart" : 28577410,
      "strand" : "-",
      "accession" : "NR_130706",
      "txEnd" : 28674729,
      "cdsStart" : 28674729
   },
   {
      "cdsStart" : 140624728,
      "txEnd" : 140624728,
      "accession" : "NR_148928",
      "strand" : "-",
      "txStart" : 140432363,
      "gene" : "BRAF",
      "cdsEnd" : 140624728,
      "exons" : [
         [140432363, 140434570],
         [140439611, 140439746],
         [140449086, 140449218],
         [140453074, 140454033],
         [140476711, 140476888],
         [140477790, 140477875],
         [140481375, 140481493],
         [140482820, 140482957],
         [140487347, 140487384],
         [140494107, 140494267],
         [140500161, 140500281],
         [140501211, 140501360],
         [140507759, 140507862],
         [140508036, 140508116],
         [140508691, 140508795],
         [140534408, 140534672],
         [140549910, 140550012],
         [140624365, 140624728]
      ],
      "chr" : "chr7"
   },
   {
      "txStart" : 25357722,
      "strand" : "-",
      "chr" : "chr12",
      "exons" : [
         [25357722, 25362845],
         [25378547, 25378707],
         [25380167, 25380346],
         [25398207, 25398329],
         [25403684, 25403865]
      ],
      "cdsEnd" : 25398318,
      "gene" : "KRAS",
      "accession" : "NM_004985",
      "txEnd" : 25403865,
      "cdsStart" : 25362728
   },
   {
      "gene" : "BRCA1",
      "exons" : [
         [41196311, 41197819],
         [41199659, 41199720],
         [41203079, 41203134],
         [41209068, 41209152],
         [41215349, 41215390],
         [41215890, 41215968],
         [41219624, 41219712],
         [41222944, 41223255],
         [41226347, 41226538],
         [41228504, 41228628],
         [41234420, 41234592],
         [41242960, 41243049],
         [41246760, 41246877],
         [41247862, 41247939],
         [41249260, 41249306],
         [41251791, 41251897],
         [41256138, 41256278],
         [41256884, 41256973],
         [41258472, 41258550],
         [41267742, 41267796],
         [41276033, 41276132],
         [41277293, 41277468]
      ],
      "cdsEnd" : 41276113,
      "chr" : "chr17",
      "strand" : "-",
      "txStart" : 41196311,
      "cdsStart" : 41197800,
      "txEnd" : 41277468,
      "accession" : "NM_007299"
   },
   {
      "accession" : "NM_007298",
      "cdsStart" : 41197694,
      "txEnd" : 41276132,
      "cdsEnd" : 41276113,
      "exons" : [
         [41196311, 41197819],
         [41199659, 41199720],
         [41201137, 41201211],
         [41203079, 41203134],
         [41209068, 41209152],
         [41215349, 41215390],
         [41215890, 41215968],
         [41219624, 41219712],
         [41222944, 41223255],
         [41226347, 41226538],
         [41228504, 41228628],
         [41234420, 41234592],
         [41242960, 41243049],
         [41246760, 41246877],
         [41247862, 41247939],
         [41249260, 41249306],
         [41251791, 41251897],
         [41256138, 41256278],
         [41256884, 41256973],
         [41258472, 41258550],
         [41267742, 41267796],
         [41276033, 41276132]
      ],
      "chr" : "chr17",
      "gene" : "BRCA1",
      "txStart" : 41196311,
      "strand" : "-"
   },
   {
      "txStart" : 41196311,
      "strand" : "-",
      "chr" : "chr17",
      "exons" : [
         [41196311, 41197819],
         [41199659, 41199720],
         [41201137, 41201211],
         [41203079, 41203134],
         [41209068, 41209152],
         [41215349, 41215390],
         [41215890, 41215968],
         [41219624, 41219712],
         [41222944, 41223255],
         [41226347, 41226538],
         [41228504, 41228631],
         [41234420, 41234592],
         [41242960, 41243049],
         [41243451, 41246877],
         [41247862, 41247939],
         [41249260, 41249306],
         [41251791, 41251897],
         [41256138, 41256278],
         [41256884, 41256973],
         [41258472, 41258550],
         [41276033, 41276132],
         [41277293, 41277468]
      ],
      "cdsEnd" : 41258543,
      "gene" : "BRCA1",
      "accession" : "NM_007297",
      "txEnd" : 41277468,
      "cdsStart" : 41197694
   },
   {
      "txStart" : 41196311,
      "strand" : "-",
      "chr" : "chr17",
      "exons" : [
         [41196311, 41197819],
         [41199659, 41199720],
         [41201137, 41201211],
         [41203079, 41203134],
         [41209068, 41209152],
         [41215349, 41215390],
         [41215890, 41215968],
         [41219624, 41219712],
         [41222944, 41223255],
         [41226347, 41226538],
         [41228504, 41228631],
         [41234420, 41234592],
         [41242960, 41243049],
         [41243451, 41246877],
         [41247862, 41247939],
         [41249260, 41249306],
         [41251791, 41251897],
         [41256138, 41256278],
         [41256884, 41256973],
         [41258472, 41258550],
         [41267742, 41267796],
         [41276033, 41276132],
         [41277287, 41277500]
      ],
      "cdsEnd" : 41276113,
      "gene" : "BRCA1",
      "accession" : "NM_007294",
      "txEnd" : 41277500,
      "cdsStart" : 41197694
   },
   {
      "accession" : "NM_033360",
      "cdsStart" : 25368374,
      "txEnd" : 25403865,
      "txStart" : 25357722,
      "strand" : "-",
      "exons" : [
         [25357722, 25362845],
         [25368370, 25368494],
         [25378547, 25378707],
         [25380167, 25380346],
         [25398207, 25398329],
         [25403684, 25403865]
      ],
      "cdsEnd" : 25398318,
      "chr" : "chr12",
      "gene" : "KRAS"
   },
   {
      "cdsEnd" : 55273310,
      "exons" : [
         [55086713, 55087058],
         [55223522, 55223639],
         [55224225, 55224352],
         [55224451, 55224525],
         [55225355, 55225446],
         [55227831, 55228031],
         [55229191, 55229324],
         [55231425, 55231516],
         [55232972, 55233130],
         [55238867, 55238906],
         [55240675, 55240817],
         [55241613, 55241736],
         [55242414, 55242513],
         [55248985, 55249171],
         [55259411, 55259567],
         [55260458, 55260534],
         [55266409, 55266556],
         [55268008, 55268106],
         [55268880, 55269048],
         [55269427, 55269475],
         [55270209, 55270318],
         [55272948, 55275773]
      ],
      "chr" : "chr7",
      "gene" : "EGFR",
      "txStart" : 55086713,
      "strand" : "+",
      "accession" : "NM_001346941",
      "cdsStart" : 55086970,
      "txEnd" : 55275773
   }
])"_json;

}
// namespace anonymous

BOOST_AUTO_TEST_CASE( testTxPos1 )
{
    using namespace std;
    using namespace varoom;
    using namespace varoom::hgvs;

    transcript_index idx;
    for (size_t i = 0; i < tx_jsons.size(); ++i)
    {
        idx.add(transcript::make(tx_jsons[i]));
    }

    {
        string c("chr2");
        hgvsg_locus g(47630152);
        genomic_locus g0(static_cast<uint64_t>(g) - 1);
        vector<reference_wrapper<const transcript>> txs;
        idx.overlapping(c, g0, txs);
        BOOST_REQUIRE_EQUAL(txs.size(), 2);
        BOOST_CHECK_EQUAL(txs[0].get().accession(), "NM_001258281");
        BOOST_CHECK_EQUAL(txs[1].get().accession(), "NM_000251");
    }
}
